(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages-media/course/course"],{125:function(t,e,i){"use strict";(function(t,e){var n=i(4);i(26);n(i(25));var o=n(i(126));t.__webpack_require_UNI_MP_PLUGIN__=i,e(o.default)}).call(this,i(1)["default"],i(2)["createPage"])},126:function(t,e,i){"use strict";i.r(e);var n=i(127),o=i(129);for(var r in o)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(r);var a,s=i(32),u=Object(s["default"])(o["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],a);u.options.__file="pages-media/course/course.vue",e["default"]=u.exports},127:function(t,e,i){"use strict";i.r(e);var n=i(128);i.d(e,"render",(function(){return n["render"]})),i.d(e,"staticRenderFns",(function(){return n["staticRenderFns"]})),i.d(e,"recyclableRender",(function(){return n["recyclableRender"]})),i.d(e,"components",(function(){return n["components"]}))},128:function(t,e,i){"use strict";var n;i.r(e),i.d(e,"render",(function(){return o})),i.d(e,"staticRenderFns",(function(){return a})),i.d(e,"recyclableRender",(function(){return r})),i.d(e,"components",(function(){return n}));try{n={fAudio:function(){return i.e("components/f-audio/f-audio").then(i.bind(null,415))},activeBar:function(){return Promise.all([i.e("common/vendor"),i.e("components/active-bar/active-bar")]).then(i.bind(null,395))},collectBtn:function(){return i.e("components/collect-btn/collect-btn").then(i.bind(null,400))},groupWorks:function(){return Promise.all([i.e("common/vendor"),i.e("components/group-works/group-works")]).then(i.bind(null,405))},uniCard:function(){return i.e("components/uni-card/uni-card").then(i.bind(null,351))},mpHtml:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/mp-html/components/mp-html/mp-html")]).then(i.bind(null,370))},mainButton:function(){return i.e("components/main-button/main-button").then(i.bind(null,358))}}}catch(s){if(-1===s.message.indexOf("Cannot find module")||-1===s.message.indexOf(".vue"))throw s;console.error(s.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var o=function(){var t=this,e=t.$createElement,i=(t._self._c,t.detail.isbuy?null:t._f("formatType")(t.detail.type));t._isMounted||(t.e0=function(e){t.detail.isfava=e}),t.$mp.data=Object.assign({},{$root:{f0:i}})},r=!1,a=[];o._withStripped=!0},129:function(t,e,i){"use strict";i.r(e);var n=i(130),o=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=o.a},130:function(t,e,i){"use strict";(function(t){var n=i(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(i(65)),r=t.getSystemInfoSync().windowHeight,a={filters:{formatType:function(t){var e={media:"图文",audio:"音频",video:"视频"};return e[t]}},data:function(){return{firstLoad:!1,detail:{id:0,title:"",cover:"",try:"",price:"",t_price:"",type:"media",sub_count:0,content:"",isbuy:!1,isfava:!1},column_id:0,scrollTop:0,mediaHeight:0,progress:0,group_id:0,activeData:null,flashsale_id:0}},onPageScroll:function(t){this.detail.isbuy&&"media"==this.detail.type&&t.scrollTop>this.scrollTop&&(this.scrollTop=t.scrollTop,this.sumMediaProgress())},onLoad:function(e){if(this.detail.id=e.id,!this.detail.id)return this.$toast("非法参数"),void setTimeout((function(){t.navigateBack({delta:1})}),700);e.column_id&&(this.column_id=e.column_id),e.group_id&&(this.group_id=e.group_id),e.flashsale_id&&(this.flashsale_id=e.flashsale_id)},onShow:function(){this.getData()},beforeDestroy:function(){this.updateUserHistory()},computed:{btn:function(){return this.detail.flashsale?"立即秒杀￥"+this.detail.flashsale.price:this.detail.group?"立即拼团￥"+this.detail.group.price:0==this.detail.price?"立即学习":"立即订购￥"+this.detail.price}},methods:{submit:function(){var e=this;if(this.group_id)return t.showLoading({title:"发起拼团中...",mask:!1}),void this.$api.createOrder({group_id:this.group_id},"group").then((function(t){o.default.wxpay(t.no,(function(){e.getData()}))})).catch((function(t){console.log(t)})).finally((function(){t.hideLoading()}));if(0==this.detail.price)return t.showLoading({title:"加载中...",mask:!1}),void this.$api.learn({goods_id:this.detail.id,type:"course"}).then((function(t){e.getData()})).finally((function(){t.hideLoading()}));var i="course",n=this.detail.id;this.detail.flashsale&&(i="flashsale",n=this.flashsale_id),this.authJump("/pages-order/create-order/create-order?id=".concat(n,"&type=").concat(i))},onAudioProgressUpdate:function(t){this.progress=t},onVideoTimeUpdate:function(t){var e=t.detail,i=e.currentTime,n=e.duration;n>0&&(this.progress=(i/n*100).toFixed(2))},updateUserHistory:function(){if(this.detail.isbuy){var t={};t=0==this.column_id?{id:this.detail.id,type:"course",progress:this.progress}:{id:this.column_id,type:"column",detail_id:this.detail.id},this.$api.updateUserHistory(t)}},onMediaReady:function(){var e=this,i=t.createSelectorQuery().in(this);i.select("#media").boundingClientRect((function(t){e.mediaHeight=parseInt(t.height),e.sumMediaProgress()})).exec()},sumMediaProgress:function(){this.mediaHeight>0&&(this.progress=((this.scrollTop+r)/this.mediaHeight*100).toFixed(2),this.progress=this.progress>100?100:this.progress)},getData:function(){var e=this;this.$api.readCourse({id:this.detail.id,column_id:this.column_id,group_id:this.group_id,flashsale_id:this.flashsale_id}).then((function(i){e.detail=i,i.group&&(e.activeData={type:"group",data:i.group},e.$refs.groupWorks.int(e.group_id)),i.flashsale&&(e.activeData={type:"flashsale",data:i.flashsale}),t.setNavigationBarTitle({title:e.detail.title})})).catch((function(e){"该记录不存在"===e&&setTimeout((function(){t.navigateBack({delta:1})}),700)})).finally((function(){e.firstLoad=!0}))}}};e.default=a}).call(this,i(2)["default"])}},[[125,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages-media/course/course.js.map